---
outline: deep
---

# Npm&Yarn&Pnpm

---

:::tip pnmp 相对于 yarn/npm 的优势

1. 更快的依赖下载
2. 更高效的利用磁盘空间
3. 更为优秀的依赖管理
   :::

### 问题一：依赖嵌套（npm2

用 node 版本管理工具把 node 版本降到 4，那 npm 版本就是 2.x 了。

<img src="/blog/Npm&Yarn&Pnpm01.png"  style="zoom: 50%;" />

1、多个包难免会有公共依赖，同样的依赖复制多次，磁盘占用大，下载速度慢

2、致命问题 windows 的文件路径最长 260 多个字符，这样的嵌套会超过 windows 路径的长度限制

### 问题二：幽灵依赖 （npm3 yarn

yarn 将所有依赖 **铺平** 这样就不会依赖重复多次的问题，同时也解决了路路径名字问题

<img src="/blog/Npm&Yarn&Pnpm02.png"  style="zoom: 50%;" />

1、我们明明没有安装的 A 包 但是却可以在 JS 中 引用，这是因为我们引用了 B 包，但是 B 包中依赖了 A 包，平铺在 node_module 中。如果某一天，我们不需要 B 包，那么代码中引用 A 包的代码将会报错

### 主角：pnpm

**优点一：节省磁盘**
pnpm 安装的真实包，都存在一个系统的隐藏路径 .pnpm-store 文件中 ，项目中的依赖只是对真实包的引用。这样十个项目的 node_module 中相同的依赖只用下载一份在 隐藏文件中 引用即可

**优点二：效率快**
pnpm 在你删除项目的某个依赖或者升级依赖的时候不会把 store 里的真实文件删除（除非执行 pnpm prune 指令 ，要求他杀出不被使用到的 store）。在切换分支，版本切换不出错，且效率跟高

**优点三：依赖合理 不拍平**
没有幽灵依赖，所有依赖都在 store 中，只是没有把引用开放给你。

**优点四：支持 workspace 可以做 monorepo（微应用**
